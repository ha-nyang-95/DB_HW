ğŸ“˜ RDD ìƒ˜í”Œë§ ë° ë¶„í•  ì‹¤ìŠµ ì •ë¦¬ë³¸
======================

âœ¨ ì‹¤ìŠµ ëª©í‘œ
-------

*   PySparkì˜ `RDD`ë¥¼ í™œìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ìƒì„±í•˜ê³ ,
    
*   `sample()`, `takeSample()`ì„ í†µí•´ **ìƒ˜í”Œë§**ì„ ìˆ˜í–‰í•˜ë©°,
    
*   `randomSplit()`ì„ ì´ìš©í•œ **ë°ì´í„° ë¶„í• **ì„ ì‹¤ìŠµí•´ë³¸ë‹¤.
    
*   ê°ê°ì˜ ìƒ˜í”Œë§ ë°©ì‹ ë° ë¶„í•  ê²°ê³¼ë¥¼ ë¹„êµ ë¶„ì„í•œë‹¤.
    

* * *

ğŸ“Œ 1. SparkContext ìƒì„±
---------------------

```python
from pyspark import SparkContext
sc = SparkContext("local", "SamplingSplitApp")
```

*   `SparkContext`: Sparkì˜ **í•µì‹¬ ì§„ì…ì **ìœ¼ë¡œ, í´ëŸ¬ìŠ¤í„°ì™€ì˜ ì—°ê²°ì„ ì„¤ì •í•˜ê³  ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì‚¬ìš©ë¨.
    
*   `"local"`: í˜„ì¬ ë¡œì»¬ ë¨¸ì‹ ì—ì„œ ì‹¤í–‰í•  ê²ƒì„ ì§€ì •.
    
*   `"SamplingSplitApp"`: ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¦„ (ë¡œê·¸ë‚˜ ì›¹ UIì—ì„œ ì‹ë³„ìš©).
    

* * *

ğŸ“Œ 2. RDD ìƒì„±
------------

```python
numbers_rdd = sc.parallelize(range(1, 101))
```

*   `sc.parallelize()`: ë¦¬ìŠ¤íŠ¸ë‚˜ ë²”ìœ„ë¥¼ **RDDë¡œ ë³€í™˜**.
    
*   ì—¬ê¸°ì„œëŠ” 1~100ê¹Œì§€ ìˆ«ìë¥¼ RDDë¡œ ë§Œë“¤ì–´ì„œ **100ê°œì˜ ë°ì´í„°ë¥¼ ê°€ì§„ RDD**ë¥¼ ìƒì„±í•¨.
    
*   `.count()`: RDDì˜ ì´ ê°œìˆ˜ë¥¼ ë°˜í™˜.
    

```python
print(f"ì›ë³¸ ë°ì´í„° ê°œìˆ˜: {numbers_rdd.count()}")
# ì¶œë ¥: ì›ë³¸ ë°ì´í„° ê°œìˆ˜: 100
```

* * *

ğŸ“Œ 3. sample(): RDD ìƒ˜í”Œë§
-----------------------

### â‘  ë¹„ë³µì› ìƒ˜í”Œë§

```python
sample_without = numbers_rdd.sample(False, 0.2)
```

*   `sample(withReplacement, fraction)`
    
*   `withReplacement=False`: ë¹„ë³µì› ìƒ˜í”Œë§ (ê°™ì€ ê°’ì€ í•œ ë²ˆë§Œ ì„ íƒë¨).
    
*   `fraction=0.2`: ì „ì²´ ë°ì´í„°ì˜ ì•½ 20%ë¥¼ ìƒ˜í”Œë¡œ ì¶”ì¶œ.
    

```python
print("ë¹„ë³µì› ìƒ˜í”Œë§ ê²°ê³¼:", sample_without.collect())
# ì˜ˆì‹œ ì¶œë ¥: [4, 16, 23, 27, ...] (ê²°ê³¼ëŠ” ì‹¤í–‰ë§ˆë‹¤ ë‹¬ë¼ì§)
```

### â‘¡ ë³µì› ìƒ˜í”Œë§

```python
sample_with = numbers_rdd.sample(True, 0.2)
```

*   `withReplacement=True`: ë³µì› ìƒ˜í”Œë§ (ê°™ì€ ê°’ì´ ì—¬ëŸ¬ ë²ˆ ë‚˜ì˜¬ ìˆ˜ ìˆìŒ).
    
*   `0.2`: ê° í•­ëª©ì´ ì„ íƒë  **í™•ë¥ **ì´ë¯€ë¡œ, ë°ì´í„° ìˆ˜ì˜ 20%ê°€ ìƒ˜í”Œë¡œ ë‚˜ì˜¨ë‹¤ê³  ë³´ì¥í•  ìˆ˜ ì—†ìŒ.
    

```python
print("ë³µì› ìƒ˜í”Œë§ ê²°ê³¼:", sample_with.collect())
# ì˜ˆì‹œ ì¶œë ¥: [5, 15, 16, 25, 50, 50, ...]
```

* * *

ğŸ“Œ 4. takeSample(): ê°œìˆ˜ ê¸°ë°˜ ìƒ˜í”Œë§
-----------------------------

### â‘  ë¹„ë³µì› ë°©ì‹

```python
take_sample_without = numbers_rdd.takeSample(False, 5)
```

*   `takeSample(withReplacement, num)`: `num`ê°œë§Œí¼ ìƒ˜í”Œì„ ì¶”ì¶œ.
    
*   ë¹„ë³µì› â†’ ì¤‘ë³µ ì—†ì´ 5ê°œ ì„ íƒ.
    

```python
print("takeSample ë¹„ë³µì›:", take_sample_without)
# ì˜ˆì‹œ: [3, 64, 54, 77, 95]
```

### â‘¡ ë³µì› ë°©ì‹

```python
take_sample_with = numbers_rdd.takeSample(True, 5)
```

*   ë³µì› â†’ ì¤‘ë³µ í—ˆìš©ë¨.
    

```python
print("takeSample ë³µì›:", take_sample_with)
# ì˜ˆì‹œ: [18, 13, 30, 23, 85]
```

* * *

ğŸ“Œ 5. randomSplit(): í›ˆë ¨/í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¶„í• 
----------------------------------

```python
train_rdd, test_rdd = numbers_rdd.randomSplit([0.8, 0.2], seed=42)
```

*   `randomSplit(weights, seed)`: ë¹„ìœ¨ ê¸°ë°˜ìœ¼ë¡œ RDD ë¶„í• .
    
*   `[0.8, 0.2]`: ì „ì²´ ë°ì´í„°ë¥¼ 8:2ë¡œ ë¶„í• .
    
*   `seed`: ëœë¤ ì‹œë“œë¥¼ ê³ ì •í•˜ì—¬ ë™ì¼ ê²°ê³¼ ì¬í˜„ ê°€ëŠ¥.
    

```python
print(f"í›ˆë ¨ ë°ì´í„° ê°œìˆ˜: {train_rdd.count()}")
print(f"í…ŒìŠ¤íŠ¸ ë°ì´í„° ê°œìˆ˜: {test_rdd.count()}")
```

â€» ë¶„í•  ì‹œ ì •í™•íˆ 80ê°œ/20ê°œê°€ ì•„ë‹Œ ì•½ê°„ì˜ ì°¨ì´ëŠ” ìˆì„ ìˆ˜ ìˆìŒ (í™•ë¥  ê¸°ë°˜ ë¶„í• ).

* * *

ğŸ“Œ 6. ìƒ˜í”Œ ê°œìˆ˜ ë¹„êµ ë¶„ì„
-----------------

```python
print(f"ë¹„ë³µì› ìƒ˜í”Œ ê°œìˆ˜: {sample_without.count()}")
print(f"ë³µì› ìƒ˜í”Œ ê°œìˆ˜: {sample_with.count()}")
```

*   `.count()`ë¥¼ í†µí•´ ìƒ˜í”Œë§ëœ RDDì˜ ì‹¤ì œ ë°ì´í„° ê°œìˆ˜ë¥¼ ë¹„êµ.
    
*   ë³µì› ìƒ˜í”Œì€ ì¤‘ë³µ í—ˆìš©ì´ë¯€ë¡œ ë” ë§ì•„ì§ˆ ìˆ˜ ìˆìŒ.
    

* * *

ğŸ“Œ 7. ì „ì²´ ì½”ë“œ
-----------------

```python
from pyspark import SparkContext
sc = SparkContext("local", "SamplingSplitApp")

# 1. 1~100ê¹Œì§€ ìˆ«ì ë°ì´í„°ë¥¼ RDDë¡œ ìƒì„±
# ì›ë³¸ ë°ì´í„° ê°œìˆ˜: 100
numbers_rdd = sc.parallelize(range(1, 101))
print(f"ì›ë³¸ ë°ì´í„° ê°œìˆ˜: {numbers_rdd.count()}")

# 2. sample() ë¹„ë³µì› ë°©ì‹ìœ¼ë¡œ 20% ìƒ˜í”Œë§
# ë¹„ë³µì› ìƒ˜í”Œë§ ê²°ê³¼: [4, 16, 23, 27, 28, 36, 40, 42, 57, 63, 67, 74, 78, 81, 86]
sample_without = numbers_rdd.sample(False, 0.2)
print("ë¹„ë³µì› ìƒ˜í”Œë§ ê²°ê³¼:", sample_without.collect())

# sample() ë³µì› ë°©ì‹ìœ¼ë¡œ 20% ìƒ˜í”Œë§
# ë³µì› ìƒ˜í”Œë§ ê²°ê³¼: [5, 15, 16, 25, 29, 33, 38, 41, 48, 50, 50, 54, 56, 65, 81, 83, 89, 92, 93]
sample_with = numbers_rdd.sample(True, 0.2)
print("ë³µì› ìƒ˜í”Œë§ ê²°ê³¼:", sample_with.collect())

# takeSample() ë¹„ë³µì›
# takeSample ë¹„ë³µì›: [3, 64, 54, 77, 95]
take_sample_without = numbers_rdd.takeSample(False, 5)
print("takeSample ë¹„ë³µì›:", take_sample_without)

# takeSample() ë³µì›
# takeSample ë³µì›: [18, 13, 30, 23, 85]
take_sample_with = numbers_rdd.takeSample(True, 5)
print("takeSample ë³µì›:", take_sample_with)

# 3. randomSplit()ìœ¼ë¡œ í›ˆë ¨/í…ŒìŠ¤íŠ¸ ë¶„í• 
# í›ˆë ¨ ë°ì´í„° ê°œìˆ˜: 81
# í…ŒìŠ¤íŠ¸ ë°ì´í„° ê°œìˆ˜: 19
train_rdd, test_rdd = numbers_rdd.randomSplit([0.8, 0.2], seed=42)
print(f"í›ˆë ¨ ë°ì´í„° ê°œìˆ˜: {train_rdd.count()}")
print(f"í…ŒìŠ¤íŠ¸ ë°ì´í„° ê°œìˆ˜: {test_rdd.count()}")

# 4. ë¹„êµ ë¶„ì„
# ë¹„ë³µì› ìƒ˜í”Œ ê°œìˆ˜: 15
# ë³µì› ìƒ˜í”Œ ê°œìˆ˜: 19
print(f"ë¹„ë³µì› ìƒ˜í”Œ ê°œìˆ˜: {sample_without.count()}")
print(f"ë³µì› ìƒ˜í”Œ ê°œìˆ˜: {sample_with.count()}")
```

* * *

ğŸ“Š ê²°ê³¼ ìš”ì•½ í‘œ
----------

| êµ¬ë¶„            | ë°©ì‹        | í•¨ìˆ˜                      | ì¤‘ë³µ | ê°œìˆ˜ ë³´ì¥ | ì˜ˆì‹œ ì¶œë ¥              |
| --------------- | ----------- | ------------------------- | ---- | --------- | ---------------------- |
| `sample()`      | ë¹„ë³µì›      | `sample(False, 0.2)`      | âŒ    | âŒ         | \[4, 16, ...\]         |
| `sample()`      | ë³µì›        | `sample(True, 0.2)`       | âœ…    | âŒ         | \[5, 15, 50, 50, ...\] |
| `takeSample()`  | ë¹„ë³µì›      | `takeSample(False, 5)`    | âŒ    | âœ…         | \[3, 54, 95, ...\]     |
| `takeSample()`  | ë³µì›        | `takeSample(True, 5)`     | âœ…    | âœ…         | \[30, 30, 85, ...\]    |
| `randomSplit()` | ë°ì´í„° ë¶„í•  | `randomSplit([0.8, 0.2])` | \-   | ë¹„ìœ¨ê¸°ë°˜  | í›ˆë ¨/í…ŒìŠ¤íŠ¸ ë¶„í•        |

* * *

ğŸ§  í•µì‹¬ ê°œë… ìš”ì•½
-----------

| ìš©ì–´               | ì„¤ëª…                                                      |
| ------------------ | --------------------------------------------------------- |
| RDD                | ë¶„ì‚°ëœ ë°ì´í„° ì§‘í•©ìœ¼ë¡œ Sparkì˜ í•µì‹¬ ë°ì´í„° êµ¬ì¡°           |
| ìƒ˜í”Œë§             | ì „ì²´ ë°ì´í„° ì¤‘ ì¼ë¶€ë§Œ ì„ íƒí•˜ì—¬ ëŒ€í‘œë¡œ ì‚¬ìš©í•˜ëŠ” ê¸°ë²•       |
| ë³µì›/ë¹„ë³µì› ìƒ˜í”Œë§ | ì„ íƒëœ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë½‘ì„ ìˆ˜ ìˆëŠ”ì§€ ì—¬ë¶€ (ì¤‘ë³µ í—ˆìš© ì—¬ë¶€) |
| `sample()`         | ë¹„ìœ¨ ê¸°ë°˜ ìƒ˜í”Œë§                                          |
| `takeSample()`     | ê°œìˆ˜ ê¸°ë°˜ ìƒ˜í”Œë§                                          |
| `randomSplit()`    | ë¹„ìœ¨ ê¸°ë°˜ RDD ë¶„í•                                         |
| `collect()`        | RDDë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜ (ë¡œì»¬ë¡œ ê°€ì ¸ì˜¤ê¸°)                     |
| `count()`          | RDDì˜ ì´ ë°ì´í„° ê°œìˆ˜ ë°˜í™˜                                 |

* * *

ğŸ“Œ ì‹¤ìŠµì„ í†µí•´ ì–»ì€ ì¸ì‚¬ì´íŠ¸
-----------------

*   RDDì˜ `sample()`ê³¼ `takeSample()`ì€ ëª©ì ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
    
*   í•™ìŠµìš© ë°ì´í„°ì…‹ì„ ë§Œë“¤ ë•ŒëŠ” `randomSplit()`ì´ ìœ ìš©í•˜ë‹¤.
    
*   ë³µì› ìƒ˜í”Œë§ì€ ë°ì´í„° ì¤‘ë³µì´ í—ˆìš©ë˜ë¯€ë¡œ ì£¼ì˜í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
    
*   ì‹¤ì‹œê°„ìœ¼ë¡œ ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ë™ì¼ ì‹¤í—˜ì„ ì¬í˜„í•˜ë ¤ë©´ `seed` ì„¤ì •ì´ ì¤‘ìš”í•˜ë‹¤.
